# æœ¬åœ°RAGç³»ç»Ÿä½¿ç”¨æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é¢„ä¸‹è½½æ¨¡å‹ï¼ˆä»…éœ€ä¸€æ¬¡ï¼‰
```bash
# è¿è¡Œé¢„ä¸‹è½½è„šæœ¬ï¼Œå°†æ¨¡å‹ä¸‹è½½åˆ°æœ¬åœ°ç¼“å­˜
python download_models.py
```

### 2. é…ç½®ç¯å¢ƒ
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘.envæ–‡ä»¶ï¼Œè®¾ç½®DeepSeek APIå¯†é’¥
DEEPSEEK_API_KEY=your-api-key-here
```

### 3. è¿è¡Œç³»ç»Ÿ
```bash
# å¯åŠ¨æœ¬åœ°RAGç³»ç»Ÿ
adk run root_agent

# æˆ–ä½¿ç”¨Pythonç›´æ¥è¿è¡Œ
python -m app.agent
```

## ğŸ“ æ–‡ä»¶ç»“æ„
```
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ local_retriever.py  # æœ¬åœ°æ£€ç´¢å™¨ï¼ˆæ”¯æŒç¼“å­˜ï¼‰
â”‚   â””â”€â”€ agent.py           # ä¸»agentï¼ˆä½¿ç”¨DeepSeekï¼‰
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ vectors.index      # FAISSå‘é‡ç´¢å¼•
â”‚   â”œâ”€â”€ texts.pkl          # æ³•å¾‹æ–‡æœ¬
â”‚   â””â”€â”€ metadatas.pkl      # å…ƒæ•°æ®
â”œâ”€â”€ chinese_law.txt        # æ³•å¾‹æ–‡æœ¬æºæ–‡ä»¶
â”œâ”€â”€ download_models.py     # æ¨¡å‹é¢„ä¸‹è½½è„šæœ¬
â””â”€â”€ .env                   # ç¯å¢ƒå˜é‡é…ç½®
```

## ğŸ”§ æœ¬åœ°ç¼“å­˜æœºåˆ¶

### ç¼“å­˜ä½ç½®
- **åµŒå…¥æ¨¡å‹**: `~/.cache/sentence_transformers/BAAI--bge-m3`
- **äº¤å‰ç¼–ç å™¨**: `~/.cache/sentence_transformer/cross-encoder--ms-marco-MiniLM-L-6-v2`

### ç¼“å­˜ä¼˜åŠ¿
- âœ… **é›¶ç½‘ç»œå»¶è¿Ÿ** - é¦–æ¬¡ä¸‹è½½åæ— éœ€ç½‘ç»œè¿æ¥
- âœ… **éšç§ä¿æŠ¤** - æ‰€æœ‰è®¡ç®—åœ¨æœ¬åœ°å®Œæˆ
- âœ… **é€Ÿåº¦æå‡** - é¿å…é‡å¤ä¸‹è½½æ¨¡å‹
- âœ… **ç¦»çº¿è¿è¡Œ** - å®Œå…¨è„±ç¦»äº’è”ç½‘ç¯å¢ƒ

## ğŸ“‹ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šå®Œå…¨ç¦»çº¿è¿è¡Œ
1. é¢„å…ˆè¿è¡Œ `python download_models.py`
2. é…ç½® `.env` æ–‡ä»¶ï¼ˆå¯ç¦»çº¿é…ç½®ï¼‰
3. è¿è¡Œç³»ç»Ÿï¼Œæ— éœ€ä»»ä½•ç½‘ç»œè¿æ¥

### åœºæ™¯2ï¼šé¦–æ¬¡ä½¿ç”¨
1. è¿è¡Œ `python download_models.py` ä¸‹è½½æ¨¡å‹
2. ç³»ç»Ÿä¼šè‡ªåŠ¨åŠ è½½æ³•å¾‹æ–‡æœ¬å¹¶å»ºç«‹ç´¢å¼•
3. åç»­ä½¿ç”¨å®Œå…¨æœ¬åœ°è¿è¡Œ

## ğŸ¯ æµ‹è¯•æŸ¥è¯¢ç¤ºä¾‹
```python
# æµ‹è¯•æŸ¥è¯¢
from app.local_retriever import create_local_retriever

retriever = create_local_retriever()
results = retriever.retrieve_and_rerank("ä¸ªäººä¿¡æ¯ä¿æŠ¤æ³•", top_k=3, top_n=2)
for result in results:
    print(result['text'])
```

## âš™ï¸ ç¯å¢ƒå˜é‡é…ç½®
```bash
# æ¨¡å‹é…ç½®ï¼ˆå¯é€‰ï¼‰
EMBEDDING_MODEL=BAAI/bge-m3
CROSS_ENCODER=cross-encoder/ms-marco-MiniLM-L-6-v2

# APIé…ç½®ï¼ˆå¿…éœ€ï¼‰
DEEPSEEK_API_KEY=your-api-key

# å­˜å‚¨è·¯å¾„ï¼ˆå¯é€‰ï¼‰
DATA_DIR=./data
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### æ¨¡å‹åŠ è½½å¤±è´¥
- æ£€æŸ¥ `~/.cache/sentence_transformers/` ç›®å½•æ˜¯å¦å­˜åœ¨æ¨¡å‹æ–‡ä»¶
- é‡æ–°è¿è¡Œ `python download_models.py`

### ç´¢å¼•å»ºç«‹å¤±è´¥
- ç¡®è®¤ `chinese_law.txt` æ–‡ä»¶å­˜åœ¨
- æ£€æŸ¥æ•°æ®ç›®å½•æƒé™

### APIè¿æ¥å¤±è´¥
- ç¡®è®¤ `DEEPSEEK_API_KEY` é…ç½®æ­£ç¡®
- æ£€æŸ¥ç½‘ç»œè¿æ¥

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡
- **ç´¢å¼•å¤§å°**: < 1MB
- **å†…å­˜å ç”¨**: < 500MB
- **æŸ¥è¯¢å»¶è¿Ÿ**: < 500msï¼ˆé¦–æ¬¡åŠ è½½æ¨¡å‹åï¼‰
- **å†·å¯åŠ¨**: < 30ç§’ï¼ˆæ¨¡å‹å·²ç¼“å­˜ï¼‰